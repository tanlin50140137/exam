<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>创建考场</title>
<link rel="stylesheet" type="text/css" href="<?php echo apth_url('subject/bim/css/bim-css.css');?>" />
<link rel="stylesheet" type="text/css" href="<?php echo apth_url('subject/bim/layer/theme/default/layer.css');?>" />
<script type="text/javascript" src="<?php echo apth_url('subject/bim/js/jquery-1.11.2.min.js');?>"></script>
<script type="text/javascript" src="<?php echo apth_url('subject/bim/js/logins.js');?>"></script>
<script type="text/javascript" src="<?php echo apth_url('subject/bim/layer/layer.js');?>"></script>
</head>
<body>
<div class="key_box">
	<h1><a href="javascript:void(0);" onclick="Diachronic();">&lt;&lt;返回</a> &nbsp; &nbsp; &nbsp; <a href="<?php echo apth_url('?act=create_room');?>">创建考场</a></h1>	
</div>
<div class="addfl" style="display:block;">
	<form id="ify_frm">
		<p>考场名称： <input type="text" name="title" value="" class="ad_fls" id="ad_fls1"/></p>
		<p>考场排序： <input type="text" name="sort" value="0" class="ad_fls" id="ad_fls2" style="width:5.8rem;"/></p>
		<p>
			题库分类：
			<select name="pid" class="ad_fls2" id="ad_fls3">
				<option value="0">请选择分类</option>
	<?php if(!empty($flRows1)){?>
		<?php foreach( $flRows1 as $k => $v ){?>
			<option value="<?php echo $v['id'];?>"><?php echo $v['title'];?></option>
		<?php }?>		
	<?php }?>
			</select>
		</p>
		<p>考场描述： <input type="text" name="descri" value="" class="ad_fls"/></p>
		<p>资费模式： <label><input type="radio" name="tariff" value="0" checked="checked" onclick="SetState(1);"/>免费</label> &nbsp; &nbsp; <label><input type="radio" name="tariff" value="1" onclick="SetState(2);"/>收费</label></p>		
		<div class="t_guizhe" style="display:none;">
			<div class="t_guizhe_list" style="font-weight:bold;">设置考场收费规则：</div>
			<div class="t_guizhe_list">
				<span style="font-weight:bold;">VIP包月：</span><br/>
				<div class="add_rules">
					<div class="cloxe_xxx">
					<span>01</span>.设置名称： <input type="text" name="r_name[]" placeholder="1个月" value="" class="r_setvals" style="width:5rem;padding:0 0.2rem;"/> &nbsp; 
					可用天数 <input type="text" name="r_day[]" placeholder="30" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> 天 &nbsp; 
					 原价格 <input type="text" name="r_srcpay[]" placeholder="20" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen;&nbsp; 
					 折后价 <input type="text" name="r_fra[]" placeholder="15" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen; &nbsp; &nbsp;  
					 <label><input type="radio" name="r_radio1" value="1" class="r_radio"/>显示原价</label> &nbsp;
					 <label><input type="radio" name="r_radio1" value="2" class="r_radio"/>显示折后价</label> &nbsp;
					 <label><input type="radio" name="r_radio1" value="3" checked="checked" class="r_radio"/>显示所有价格</label> &nbsp; &nbsp; &nbsp; &nbsp;
					 <label><input type="checkbox" name="r_on[]" value="on" class="r_setons" />选用此规则</label>
					 </div>
					 <div class="cloxe_xxx">
					 <span>02</span>.设置名称： <input type="text" name="r_name[]" placeholder="3个月" value="" class="r_setvals" style="width:5rem;padding:0 0.2rem;"/> &nbsp; 
					可用天数 <input type="text" name="r_day[]" placeholder="90" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> 天 &nbsp; 
					 原价格 <input type="text" name="r_srcpay[]" placeholder="60" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen;&nbsp; 
					 折后价 <input type="text" name="r_fra[]" placeholder="55" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen; &nbsp; &nbsp; 
					 <label><input type="radio" name="r_radio2" value="1" class="r_radio"/>显示原价</label> &nbsp;
					 <label><input type="radio" name="r_radio2" value="2" class="r_radio"/>显示折后价</label> &nbsp;
					 <label><input type="radio" name="r_radio2" value="3" checked="checked" class="r_radio"/>显示所有价格</label> &nbsp; &nbsp; &nbsp; &nbsp;
					 <label><input type="checkbox" name="r_on[]" value="on" class="r_setons" />选用此规则</label>
					 </div>
					 <div class="cloxe_xxx">
					 <span>03</span>.设置名称： <input type="text" name="r_name[]" placeholder="6个月" value="" class="r_setvals" style="width:5rem;padding:0 0.2rem;"/> &nbsp; 
					可用天数 <input type="text" name="r_day[]" placeholder="180" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> 天 &nbsp; 
					 原价格 <input type="text" name="r_srcpay[]" placeholder="120" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen;&nbsp; 
					 折后价 <input type="text" name="r_fra[]" placeholder="115" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen; &nbsp; &nbsp; 
					 <label><input type="radio" name="r_radio3" value="1" class="r_radio"/>显示原价</label> &nbsp;
					 <label><input type="radio" name="r_radio3" value="2" class="r_radio"/>显示折后价</label> &nbsp;
					 <label><input type="radio" name="r_radio3" value="3" checked="checked" class="r_radio"/>显示所有价格</label> &nbsp; &nbsp; &nbsp; &nbsp;
					 <label><input type="checkbox" name="r_on[]" value="on" class="r_setons" />选用此规则</label>
					 </div>
					 <div class="cloxe_xxx">
					 <span>04</span>.设置名称： <input type="text" name="r_name[]" placeholder="1年" value="" class="r_setvals" style="width:5rem;padding:0 0.2rem;"/> &nbsp; 
					可用天数 <input type="text" name="r_day[]" placeholder="365" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> 天 &nbsp; 
					 原价格 <input type="text" name="r_srcpay[]" placeholder="240" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen;&nbsp; 
					 折后价 <input type="text" name="r_fra[]" placeholder="225" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen; &nbsp; &nbsp; 
					 <label><input type="radio" name="r_radio4" value="1" class="r_radio"/>显示原价</label> &nbsp;
					 <label><input type="radio" name="r_radio4" value="2" class="r_radio"/>显示折后价</label> &nbsp;
					 <label><input type="radio" name="r_radio4" value="3" checked="checked" class="r_radio"/>显示所有价格</label> &nbsp; &nbsp; &nbsp; &nbsp;
					 <label><input type="checkbox" name="r_on[]" value="on" class="r_setons" />选用此规则</label>
					 </div>
					 <div class="cloxe_xxx">
					 <span>05</span>.设置名称： <input type="text" name="r_name[]" placeholder="2年" value="" class="r_setvals" style="width:5rem;padding:0 0.2rem;"/> &nbsp; 
					可用天数 <input type="text" name="r_day[]" placeholder="720" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> 天 &nbsp; 
					 原价格 <input type="text" name="r_srcpay[]" placeholder="480" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen;&nbsp; 
					 折后价 <input type="text" name="r_fra[]" placeholder="445" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen; &nbsp; &nbsp; 
					 <label><input type="radio" name="r_radio5" value="1" class="r_radio"/>显示原价</label> &nbsp;
					 <label><input type="radio" name="r_radio5" value="2" class="r_radio"/>显示折后价</label> &nbsp;
					 <label><input type="radio" name="r_radio5" value="3" checked="checked" class="r_radio"/>显示所有价格</label> &nbsp; &nbsp; &nbsp; &nbsp;
					 <label><input type="checkbox" name="r_on[]" value="on" class="r_setons" />选用此规则</label>
					 </div>
					 <div class="cloxe_xxx">
					 <span>06</span>.设置名称： <input type="text" name="r_name[]" placeholder="3年" value="" class="r_setvals" style="width:5rem;padding:0 0.2rem;"/> &nbsp; 
					可用天数 <input type="text" name="r_day[]" placeholder="1080" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> 天 &nbsp; 
					 原价格 <input type="text" name="r_srcpay[]" placeholder="720" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen;&nbsp; 
					 折后价 <input type="text" name="r_fra[]" placeholder="700" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen; &nbsp; &nbsp;
					 <label><input type="radio" name="r_radio6" value="1" class="r_radio"/>显示原价</label> &nbsp;
					 <label><input type="radio" name="r_radio6" value="2" class="r_radio"/>显示折后价</label> &nbsp;
					 <label><input type="radio" name="r_radio6" value="3" checked="checked" class="r_radio"/>显示所有价格</label> &nbsp; &nbsp; &nbsp; &nbsp;
					 <label><input type="checkbox" name="r_on[]" value="on" class="r_setons" />选用此规则</label>
					 </div>
				 </div>
				 <input type="button" value="添加规则" onclick="AddRules();"/>
			</div>
		</div>
		<p>考场设置： 
		<label><input type="radio" name="setting" value="0" />练习</label> &nbsp; &nbsp; 
		<label><input type="radio" name="setting" value="1" />历年真考</label> &nbsp; &nbsp; 
		<label><input type="radio" name="setting" value="2" />随机模拟</label> &nbsp; &nbsp; 
		<label><input type="radio" name="setting" value="3" />专家模拟</label> &nbsp; &nbsp; 
		</p>
		<p>考场状态： <label><input type="radio" name="state" value="0" checked="checked"/>显示</label> &nbsp; &nbsp; <label><input type="radio" name="state" value="1"/>隐藏</label></p>
		<div> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<input type="button" value="创建" class="sbm_fl" onclick="add_classify();"/></div>
	</form>
</div>
<script>
function AddRules()
{	
	var i = $(".cloxe_xxx").length;
	
	var html = '';
	html += '<div class="cloxe_xxx"><span>'+setInts(i+1)+'</span>.设置名称： <input type="text" name="r_name[]" placeholder="填写名称" value="" class="r_setvals" style="width:5rem;padding:0 0.2rem;"/> &nbsp; ';
	html += '可用天数 <input type="text" name="r_day[]" placeholder="0" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> 天 &nbsp; ';
	html += '原价格 <input type="text" name="r_srcpay[]" placeholder="0" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen;&nbsp; ';
	html += ' 折后价 <input type="text" name="r_fra[]" placeholder="0" value="" class="r_setvals" style="width:2rem;padding:0 0.2rem;"/> &yen; &nbsp; &nbsp; ';
	html += '<label><input type="radio" name="r_radio'+(i+1)+'" value="1" class="r_radio"/>显示原价</label> &nbsp; ';
	html += '<label><input type="radio" name="r_radio'+(i+1)+'" value="2" class="r_radio"/>显示折后价</label> &nbsp; ';
	html += '<label><input type="radio" name="r_radio'+(i+1)+'" value="3" checked="checked" class="r_radio"/>显示所有价格</label> &nbsp; &nbsp; &nbsp; &nbsp; ';
	html += '<label><input type="checkbox" name="r_on[]" value="on" class="r_setons" />选用此规则</label> &nbsp;  &nbsp; </div>';
	$(".add_rules").append(html);	
}
function SetState(t)
{
	if( t == 1 )
	{
		$(".r_setvals").val('');
		$(".r_setons").attr({"checked":false});
		$(".t_guizhe").hide();
	}
	else if( t == 2 )
	{
		$(".t_guizhe").show();
	}
}
function setInts(i)
{
	if(i<10)
	{
		i = '0'+i;
	}	
	return i;
}
function add_classify()
{
	var datas = $("#ify_frm").serialize();

	var title = $("[name='title']").val();
	var sort = $("[name='sort']").val();
	
	if( title == '' )
	{
		layer.tips('请输入分类名称', '#ad_fls1');
		return false;
	}
	if( sort == '' )
	{
		layer.tips('排序号不能为空，请输入整数。', '#ad_fls2');
		return false;
	}
	var pid = $("[name='pid']").val();
	if( pid == 0 )
	{
		layer.tips('请选择分类', '#ad_fls3');
		return false;
	}
	var setting = $("[name='setting']");
	if( !setting.is(":checked") )
	{
		layer.msg('请设置考场');
		return false;
	}
	$.ajax({
		url:'<?php echo apth_url("index.php");?>',
		type:'post',
		data:'act=add_room&'+datas,
		success:function(data){
			//console.log(data);return false;
			var obj = eval("("+data+")");
			if( obj.error == 0 )
			{
				layer.msg(obj.txt,{time:1000},function(){
					location.href="<?php echo apth_url('?act=examqm');?>";
				});
			}
			else
			{
				layer.msg(obj.txt);
			}	
		}
	});	
}
function Diachronic(){
	window.history.go(-1);
}
</script>
</body>
</html>